# vk_api_bot

## Описание

Бот для Mattermost, реализующий систему голосований с помощью slash-команд. Пользователи могут создавать голосования, голосовать, просматривать результаты, завершать и удалять голосования.

Бэкенд написан на Go, для хранения используется Tarantool. Развёртывание — через `docker-compose`.

## Реализованные команды

1. **Создание голосования**  
   ```
   /vote create "Ваш вопрос?" "Вариант 1" "Вариант 2" ...
   ```
   Бот возвращает ID голосования и варианты для голосования.

2. **Голосование**  
   ```
   /vote cast <poll_id> <option>
   ```
   Пользователь голосует за выбранный вариант.

3. **Просмотр результатов**  
   ```
   /vote results <poll_id>
   ```
   Показывает, сколько голосов набрал каждый вариант.

4. **Завершение голосования**  
   ```
   /vote close <poll_id>
   ```
   Завершает голосование (может выполнить только автор).

5. **Удаление голосования**  
   ```
   /vote delete <poll_id>
   ```
   Удаляет голосование (может выполнить только автор).

## Запуск проекта

```bash
docker-compose up --build
```

## Настройки Mattermost

1. Зайти в System Console → **Integrations** → **Custom slash commands**
2. Создать новую команду:
   - Trigger word: `vote`
   - Request URL: `http://bot:8080/vote`
   - Response username: `VotingBot` (на выбор)

## Структура проекта

- `cmd/` — точка входа в приложение
- `internal/handler/` — HTTP-обработчики
- `internal/service/` — бизнес-логика голосований
- `internal/storage/` — хранилище (Tarantool)
- `internal/middleware/` — логгирование и middleware-функции
- `Dockerfile` — сборка Go-сервиса
- `docker-compose.yml` — развёртывание всех сервисов

## Пример команды

```
/vote create "Пицца или суши?" "Пицца" "Суши"
```

```
/vote cast <poll_id> "Пицца"
```

```
/vote results <poll_id>
```